<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Catálogo de Tours</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f7f7;
      padding: 30px;
    }
    h2 {
      text-align: center;
      color: #02535a;
    }
    .tabla-container {
      max-width: 900px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 18px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: left;
    }
    th {
      background: #02535a;
      color: white;
    }
    .btn-agregar {
      background: #02535a;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 6px;
      cursor: pointer;
    }
    .btn-estado {
      padding: 5px 10px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      color: white;
    }
    .activo {
      background: #28a745;
    }
    .inactivo {
      background: #dc3545;
    }
  </style>
</head>
<body>
  <h2>Catálogo de Tours</h2>
  <div class="tabla-container">
    <button class="btn-agregar" onclick="agregarTour()">➕ Nuevo Tour</button>
    <table>
      <thead>
        <tr>
          <th>Nombre</th>
          <th>Precio</th>
          <th>Estado</th>
          <th>Acción</th>
        </tr>
      </thead>
      <tbody id="tabla-body">
        <tr><td colspan="4">Cargando tours...</td></tr>
      </tbody>
    </table>
  </div>

  <script>
    const urlAppsScript = 'https://script.google.com/macros/s/AKfycbxhyot_tours1-BAWzk1tu17GMQgn55m9zm-q_V40EfArXuoI9hwse6sG9voePXlx1PYTY4g/exec?tipo=listar%20tours';

    fetch('https://proxy-tours.cris-delgado21.workers.dev/?url=' + encodeURIComponent(urlAppsScript))
      .then(response => response.json())
      .then(data => {
        cargarTablaTours(data);
      })
      .catch(error => {
        console.error('Error al cargar tours:', error);
        document.getElementById('tabla-body').innerHTML =
          '<tr><td colspan="4">Error al cargar tours.</td></tr>';
      });

    function cargarTablaTours(tours) {
      const tbody = document.getElementById('tabla-body');
      tbody.innerHTML = '';

      if (!tours || tours.length === 0) {
        tbody.innerHTML = '<tr><td colspan="4">No hay tours disponibles.</td></tr>';
        return;
      }

      tours.forEach(tour => {
        const fila = document.createElement('tr');

        fila.innerHTML = `
          <td>${tour.nombre}</td>
          <td>${tour.precio}</td>
          <td>
            <button class="btn-estado ${tour.estado === 'Activo' ? 'activo' : 'inactivo'}"
              onclick="cambiarEstado('${tour.id}', '${tour.estado}')">
              ${tour.estado}
            </button>
          </td>
          <td><button onclick="editarTour('${tour.id}')">Editar</button></td>
        `;

        tbody.appendChild(fila);
      });
    }

    function agregarTour() {
      alert('Aquí se abriría un formulario emergente para agregar un nuevo tour.');
      // Puedes implementar un modal con HTML/CSS si lo deseas.
    }

    function cambiarEstado(id, estadoActual) {
      alert(`Aquí cambiarías el estado del tour con ID: ${id}`);
      // Podrías implementar la lógica para activar/desactivar usando otro endpoint.
    }

    function editarTour(id) {
      alert(`Aquí editarías el tour con ID: ${id}`);
      // Redirigir a un formulario de edición o mostrar un modal.
    }
  </script>
</body>
</html>
