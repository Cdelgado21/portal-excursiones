<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Detalle de Reserva</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f0f7f7;
      color: #02535a;
      margin: 0;
      padding: 20px;
    }
    h2 {
      background-color: #02535a;
      color: white;
      padding: 10px;
      border-radius: 8px;
    }
    section {
      background: white;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
    }
    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }
    input, select, textarea {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    button {
      background-color: #02535a;
      color: white;
      padding: 10px 20px;
      border: none;
      margin-top: 10px;
      border-radius: 6px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<h2>Detalle de Reserva</h2>

<section>
  <label for="codigoCotizacion">Código de Cotización</label>
  <input type="text" id="codigoCotizacion" placeholder="Ej: COT-003-2025">
  <button onclick="cargarDesdeCotizacion()">Cargar Información</button>
  <div id="infoCotizacion"></div>
</section>

<section>
  <h2>Información del Titular</h2>

  <!-- Fila 1 -->
  <div style="display: flex; gap: 20px; flex-wrap: wrap;">
    <div style="flex: 1; min-width: 250px;">
      <label for="nombreTitular">Nombre Completo</label>
      <input type="text" id="nombreTitular" placeholder="Ej. María Fernández Rodríguez">
    </div>

    <div style="flex: 1; min-width: 250px;">
      <label for="cedulaTitular">Cédula o Pasaporte</label>
      <input type="text" id="cedulaTitular" placeholder="Ej. 012345678">
    </div>
    
  </div>
  <!-- Fila 2 -->
  <div style="display: flex; gap: 20px; flex-wrap: wrap; margin-top: 15px;">
    <div style="flex: 1; min-width: 250px;">
      <label for="vencimientoPasaporteTitular">Fecha de Vencimiento del Pasaporte</label>
      <input type="date" id="vencimientoPasaporteTitular">
    </div>

<div style="flex: 1; min-width: 250px;">
  <label for="fechaNacimientoTitular">Fecha de Nacimiento</label>
  <div style="display: flex; align-items: center; gap: 10px;">
    <input type="date" id="fechaNacimientoTitular" onchange="mostrarEdadTitular()">
    <span id="edadTitular" style="font-weight: bold; white-space: nowrap;">Edad: -</span>
  </div>
  </div>
</div>

 <!-- Fila 3 -->
<div style="display: flex; gap: 20px; flex-wrap: wrap; margin-top: 15px;">
  <div style="flex: 1; min-width: 250px;">
    <label for="correoTitular">Correo Electrónico</label>
    <input type="email" id="correoTitular" placeholder="Ej. maria@email.com" style="width: 100%;">
  </div>

  <div style="flex: 1; min-width: 250px;">
    <label for="telefonoTitular">Número de Teléfono</label>
    <input type="tel" id="telefonoTitular" placeholder="Ej. 8888-8888" style="width: 100%;">
  </div>
 </div>
<div style="display: flex; gap: 20px; flex-wrap: wrap; margin-top: 15px;">

  <!-- Nacionalidad -->
  <div style="flex: 1; min-width: 250px;">
    <label for="nacionalidadTitular">Nacionalidad</label>
    <input type="text" id="nacionalidadTitular" placeholder="Ej. Costarricense" style="width: 100%;">
  </div>

  <!-- Género -->
<div style="flex: 1; min-width: 180px;">
  <label for="generoTitular">Género</label>
  <select id="generoTitular" style="width: 100%;">
    <option value="">Seleccione</option>
    <option value="Femenino">Femenino</option>
    <option value="Masculino">Masculino</option>

   </select>
</div>


</div>
</section>

<section>
  <h3>Pasajeros</h3>
  <div id="pasajerosContainer"></div>
  <button onclick="agregarPasajero()">Agregar Pasajero</button>
    <div id="pasajerosContainer" style="margin-top: 15px;"></div>
</section>

<section>

  <h2>Itinerario de Vuelos</h2>
  
<h3>Vuelo de Ida</h3>
<div style="display: flex; gap: 20px; align-items: center; flex-wrap: wrap; margin-bottom: 10px;">
  
  <!-- Aerolínea -->
  <div style="display: flex; align-items: center; gap: 6px;">
    <label for="aerolineaIda">Aerolínea:</label>
    <select id="aerolineaIda" style="min-width: 160px;">
      <option value="">Seleccione una</option>
      <option value="Avianca">Avianca</option>
      <option value="Volaris">Volaris</option>
      <option value="Copa Airlines">Copa Airlines</option>
      <option value="Wingo">Wingo</option>
    </select>
  </div>

  <!-- Fecha -->
  <div style="display: flex; align-items: center; gap: 6px;">
    <label for="fechaIda">Fecha:</label>
    <input type="date" id="fechaIda" style="min-width: 140px;">
  </div>

  <!-- N° de Vuelo -->
  <div style="display: flex; align-items: center; gap: 6px;">
    <label for="vueloIda" style="white-space: nowrap;">N° de Vuelo:</label>
    <input type="text" id="vueloIda" placeholder="Ej. AV637" style="min-width: 130px;">
  </div>
  <div style="display: flex; align-items: center; gap: 6px;">
  <label for="codigoBoletoIda" style="white-space: nowrap;">Código de Aerolínea:</label>
  <input type="text" id="codigoBoletoIda" placeholder="Ej. AUC5TG" style="min-width: 160px;">
</div>

</div>


<label for="infoVueloIda">Información del Vuelo de Ida</label>
<textarea id="infoVueloIda" rows="3" placeholder="Ej. SJO → PTY → MDE, llegada 9:30 AM"></textarea>
<button id="btnAgregarVuelo" style="font-size: 12px; padding: 6px 12px;">➕ Agregar Vuelo Intermedio</button>
  </div>
  <div id="vuelosIntermediosContainer"></div>
  
 <h3>Vuelo de Regreso</h3>
<div style="display: flex; gap: 20px; align-items: center; flex-wrap: wrap; margin-bottom: 10px;">
  
  <!-- Aerolínea -->
  <div style="display: flex; align-items: center; gap: 6px;">
    <label for="aerolineaIda">Aerolínea:</label>
    <select id="aerolineaIda" style="min-width: 160px;">
      <option value="">Seleccione una</option>
      <option value="Avianca">Avianca</option>
      <option value="Volaris">Volaris</option>
      <option value="Copa Airlines">Copa Airlines</option>
      <option value="Wingo">Wingo</option>
    </select>
  </div>

  <!-- Fecha -->
  <div style="display: flex; align-items: center; gap: 6px;">
    <label for="fechaIda">Fecha:</label>
    <input type="date" id="fechaIda" style="min-width: 140px;">
  </div>

  <!-- N° de Vuelo -->
  <div style="display: flex; align-items: center; gap: 6px;">
    <label for="vueloIda" style="white-space: nowrap;">N° de Vuelo:</label>
    <input type="text" id="vueloIda" placeholder="Ej. AV637" style="min-width: 130px;">
  </div>
      <div style="display: flex; align-items: center; gap: 6px;">
   <label for="codigoBoletoRegreso" style="white-space: nowrap;">Código de Aerolínea:</label>
  <input type="text" id="codigoBoletoRegreso" placeholder="Ej. AUC5TG" style="min-width: 160px;">
</div>

<label for="infoVueloRegreso">Información del Vuelo de Regreso</label>
<textarea id="infoVueloRegreso" rows="3" placeholder="Ej. MDE → PTY → SJO, llegada 6:45 PM"></textarea>
</div>
     <h3>Equipaje</h3>
       <div style="display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 10px;">
 <div style="flex: 1; min-width: 200px;">
      <label for="tipo_equipaje">Tipo de Equipaje</label>
      <select id="tipo_equipaje">
        <option value="">-- Seleccionar --</option>
        <option value="Artículo personal">Artículo personal</option>
        <option value="Maleta de mano">Maleta de mano de 10Kg</option>
        <option value="Maleta documentada">Maleta documentada de 23kg</option>
      </select>
    </div>

  <div style="flex: 1; min-width: 120px;">
      <label for="cantidad_equipaje">Cantidad</label>
      <input type="number" id="cantidad_equipaje" placeholder="Ej. 2">
    </div>
         
      <div style="flex: 1; min-width: 180px;">
      <label for="uso_equipaje">Uso</label>
      <select id="uso_equipaje">
        <option value="">-- Seleccionar --</option>
        <option value="Por persona">Por persona</option>
        <option value="Compartido">Compartido</option>
      </select>
    </div>
  </div>

 <button onclick="agregarEquipaje()" style="margin-bottom: 15px;">➕ Agregar equipaje</button>

  <label style="margin-top: 15px;">Resumen de Equipaje</label>
  <textarea id="equipaje" readonly rows="5" placeholder="Aquí aparecerán los tipos de equipaje agregados."></textarea>
</section>
<section style="margin-top: 30px;">
  <h2 style="background-color: #02535a; color: white; padding: 10px; border-radius: 8px;">Itinerario de Tours</h2>

  <!-- Fila 1: Destino y Duración -->
  <div style="display: flex; flex-wrap: wrap; gap: 20px; margin-top: 15px;">
    <div style="flex: 1; min-width: 250px;">
      <label><strong>Destino</strong></label>
      <select id="destino" onchange="cargarInfoTour(this.value)" style="width: 100%; padding: 8px;">
        <option value="">Seleccione un destino</option>
      </select>
    </div>
    <div style="flex: 1; min-width: 250px;">
      <label><strong>Duración</strong></label>
      <input id="duracion" readonly placeholder="Ej. 5 días y 4 noches" style="width: 100%; padding: 8px;">
    </div>
  </div>
  <div id="hotelesContainer"></div>
  <button onclick="abrirModalHotel()" style="margin-top: 15px; background-color: #02535a; color: white; border: none; padding: 10px 16px; border-radius: 8px;">
    ➕ Agregar Hotel
  </button>
</section>
<div id="modalHotel" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background-color:rgba(0,0,0,0.4); z-index:9999; align-items:center; justify-content:center;">
  <div style="background:white; padding:30px; border-radius:12px; width:90%; max-width:600px; position:relative;">
    <h3 style="margin-top:0; color:#02535a;">Agregar Hotel</h3>

    <label>Nombre del Hotel</label>
    <input type="text" id="modal_nombre_hotel" placeholder="Ej. Hotel Estelar Medellín" style="width:100%; margin-bottom:10px; padding:8px;">

    <label>Hora Check-in</label>
    <input type="time" id="modal_checkin" style="width:100%; margin-bottom:10px; padding:8px;">

    <label>Hora Check-out</label>
    <input type="time" id="modal_checkout" style="width:100%; margin-bottom:10px; padding:8px;">

    <label>Tipo de habitación</label>
    <select id="modal_tipoHabitacion_hotel" style="width:100%; margin-bottom:10px; padding:8px;">
      <option value="Doble">Doble</option>
      <option value="Triple">Triple</option>
      <option value="Cuádruple">Cuádruple</option>
    </select>
<table style="width: 100%; border-collapse: collapse;" id="tablaHoteles">
  <thead style="background: #02535a; color: white;">
    <tr>
      <th>Hotel</th>
      <th>Check-in</th>
      <th>Check-out</th>
      <th>Tipo de Habitación</th>
      <th>Cantidad</th>
      <th>Observaciones</th>
    </tr>
  </thead>
  <tbody id="tablaHotelesBody">
    <!-- Se insertarán aquí -->
  </tbody>
</table>
    <label>Cantidad</label>
    <input type="number" id="modal_cantidadHabitacion_hotel" placeholder="Ej. 2" style="width:100%; margin-bottom:10px; padding:8px;">

    <label>Observaciones</label>
    <textarea id="modal_observaciones_hotel" rows="3" placeholder="Ej. Vista al mar, habitación conectada..." style="width:100%; padding:8px;"></textarea>

    <div style="margin-top:15px; text-align:right;">
      <button onclick="cerrarModalHotel()" style="margin-right:10px; background:#ccc; border:none; padding:8px 14px; border-radius:6px;">Cancelar</button>
      <button onclick="guardarHotelModal()" style="background:#02535a; color:white; border:none; padding:8px 16px; border-radius:6px;">Guardar</button>
    </div>
  </div>
</div>
</table>

    </div>
  </div>
</div>

  <!-- Fila 4: Itinerario -->
  <div style="margin-top: 20px;">
    <label for="itinerario"><strong>Itinerario</strong></label>
    <textarea id="itinerario" rows="4" placeholder="Ej. Día 1 Llegada..." style="width: 100%; padding: 8px;"></textarea>
  </div>

  <!-- Fila 5: Tours Opcionales -->
  <div style="margin-top: 30px;">
    <label style="font-weight: bold;">Tours Opcionales</label>
    <div id="toursOpcionalesLista" style="display: flex; flex-wrap: wrap; gap: 15px; margin-top: 10px;"></div>
  </div>

  <!-- Observaciones -->
  <div style="margin-top: 15px;">
    <label><strong>Observaciones sobre Tours Opcionales</strong></label>
    <textarea id="obs_tours_opcionales" rows="2" placeholder="Ej: Solo adultos harán el tour de Nápoles. Niños no participan en parapente." style="width: 100%; padding: 8px;"></textarea>
  </div>
</section>


<script>
const firebaseConfig = {
    apiKey: "AIzaSyDUEZgkrW-3HbZu2BLej4v0mbDHZf2vRo8",
    authDomain: "tours-460717.firebaseapp.com",
    projectId: "tours-460717",
    storageBucket: "tours-460717.firebasestorage.app",
    messagingSenderId: "1000749333444",
    appId: "1:1000749333444:web:73437891b59a96b6a4c291",
    measurementId: "G-CKZL71GV1W"
  };

  // Inicializar Firebase con compat
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // Cargar cotización
  function cargarDesdeCotizacion() {
    const codigo = document.getElementById('codigoCotizacion').value.trim();
    const contenedor = document.getElementById("infoCotizacion");
    if (!codigo) return alert("Por favor ingresa un código de cotización.");
    contenedor.innerHTML = "Cargando información...";
    db.collection("cotizaciones").doc(codigo).get().then(doc => {
      if (doc.exists) {
        const data = doc.data();
        contenedor.innerHTML = `
          <h3>Resumen</h3>
          <p><strong>Destino:</strong> ${data.destino || 'No disponible'}</p>
          <p><strong>Aerolínea:</strong> ${data.aerolinea || 'No disponible'}</p>
          <p><strong>Hotel:</strong> ${data.hotel || 'No disponible'}</p>
          <p><strong>Incluye:</strong> ${data.incluye || 'No disponible'}</p>
        `;
      } else {
        contenedor.innerHTML = `<p style="color:red;">No se encontró una cotización con ese código.</p>`;
      }
    }).catch(err => {
      console.error(err);
      contenedor.innerHTML = `<p style="color:red;">Error al cargar datos.</p>`;
    });
  }

  // Agregar vuelo intermedio
  let vueloCounter = 1;
  function agregarVueloIntermedio() {
    const container = document.getElementById("vuelosIntermediosContainer");
    const html = `
     <div style="display: flex; gap: 20px; align-items: center; flex-wrap: wrap; margin-bottom: 10px;">
  
  <!-- Aerolínea -->
  <div style="display: flex; align-items: center; gap: 6px;">
    <label for="aerolineaIda">Aerolínea:</label>
    <select id="aerolineaIda" style="min-width: 160px;">
      <option value="">Seleccione una</option>
      <option value="Avianca">Avianca</option>
      <option value="Volaris">Volaris</option>
      <option value="Copa Airlines">Copa Airlines</option>
      <option value="Wingo">Wingo</option>
    </select>
  </div>

  <!-- Fecha -->
  <div style="display: flex; align-items: center; gap: 6px;">
    <label for="fechaIda">Fecha:</label>
    <input type="date" id="fechaIda" style="min-width: 140px;">
  </div>

  <!-- N° de Vuelo -->
  <div style="display: flex; align-items: center; gap: 6px;">
    <label for="vueloIda" style="white-space: nowrap;">N° de Vuelo:</label>
    <input type="text" id="vueloIda" placeholder="Ej. AV637" style="min-width: 130px;">
  </div>
  <div style="display: flex; align-items: center; gap: 6px;">
  <label style="white-space: nowrap;">Código de Aerolínea:</label>
  <input type="text" placeholder="Ej. AUC5TG" style="min-width: 160px;">
</div>

 </div>
      <label style="display:block; margin-top: 10px;">Información del Vuelo</label>
      <textarea placeholder="Ej. Cartagena → Bogotá, escala de 2h" rows="2" style="width: 100%;"></textarea>
    </section>
    
  `;
    container.insertAdjacentHTML("beforeend", html);
    vueloCounter++;
  }

function agregarPasajero() {
  const container = document.getElementById("pasajerosContainer");

  const pasajeroDiv = document.createElement("div");
  pasajeroDiv.classList.add("tarjeta-pasajero");
  pasajeroDiv.style = `
    border: 1px solid #ccc;
    padding: 20px;
    margin-bottom: 20px;
    border-radius: 12px;
    background: white;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    position: relative;
  `;

  pasajeroDiv.innerHTML = `
    <span onclick="this.parentElement.remove()" 
          style="position:absolute; top:10px; right:10px; cursor:pointer; color:#b00020; font-weight:bold;">❌</span>

    <h4 style="color:#02535a; margin-bottom: 15px;">Pasajero</h4>

    <!-- Fila 1 -->
    <div style="display: flex; gap: 20px; flex-wrap: wrap;">
      <div style="flex: 1; min-width: 250px;">
        <label>Nombre Completo</label>
        <input type="text" class="nombrePasajero" placeholder="Ej. Juan Pérez" style="width: 100%;">
      </div>

      <div style="flex: 1; min-width: 250px;">
        <label>Cédula o Pasaporte</label>
        <input type="text" class="documentoPasajero" placeholder="Ej. 123456789" style="width: 100%;">
      </div>
    </div>

    <!-- Fila 2 -->
   <div style="display: flex; gap: 20px; flex-wrap: wrap; margin-top: 15px;">
    <div style="flex: 1; min-width: 250px;">
      <label>Fecha de Vencimiento del Pasaporte</label>
        <input type="date" class="vencimientoPasaportePasajero" style="width: 100%;">
    </div>

<div style="flex: 1; min-width: 250px;">
  <label for="fechaNacimientoTitular">Fecha de Nacimiento</label>
   <div style="display: flex; align-items: center; gap: 10px;">
          <input type="date" class="fechaNacimientoPasajero" onchange="calcularEdadPasajero(this)" style="width: 100%;">
          <span class="edadPasajero" style="font-weight: bold; white-space: nowrap;">Edad: -</span>
        </div>
          </div>
</div>
    <!-- Fila 3 -->
    <div style="display: flex; gap: 20px; flex-wrap: wrap; margin-top: 12px;">
      <div style="flex: 1; min-width: 200px;">
        <label>Nacionalidad</label>
        <input type="text" class="nacionalidadPasajero" placeholder="Ej. Costarricense" style="width: 100%;">
      </div>

      <div style="flex: 1; min-width: 200px;">
        <label>Género</label>
        <select class="generoPasajero" style="width: 100%;">
          <option value="">Seleccione</option>
          <option value="Femenino">Femenino</option>
          <option value="Masculino">Masculino</option>
        </select>
      </div>
    </div>
  `;

  container.appendChild(pasajeroDiv);
}

function calcularEdadPasajero(inputFecha) {
  const fecha = new Date(inputFecha.value);
  const hoy = new Date();
  let edad = hoy.getFullYear() - fecha.getFullYear();
  const m = hoy.getMonth() - fecha.getMonth();
  if (m < 0 || (m === 0 && hoy.getDate() < fecha.getDate())) {
    edad--;
  }

  const edadSpan = inputFecha.parentElement.querySelector('.edadPasajero');
  edadSpan.textContent = isNaN(edad) ? "Edad: -" : `Edad: ${edad}`;
}

document.getElementById("fechaNacimientoTitular").addEventListener("change", function () {
  const fecha = this.value;
  const edad = calcularEdad(fecha);
  document.getElementById("edadTitular").textContent = `Edad: ${edad} años`;
});

function calcularEdad(fechaNacimiento) {
  const hoy = new Date();
  const nacimiento = new Date(fechaNacimiento);
  let edad = hoy.getFullYear() - nacimiento.getFullYear();
  const mes = hoy.getMonth() - nacimiento.getMonth();
  if (mes < 0 || (mes === 0 && hoy.getDate() < nacimiento.getDate())) {
    edad--;
  }
  return edad;
}
 function agregarEquipaje() {
  const tipo = document.getElementById("tipo_equipaje").value;
  const cantidad = document.getElementById("cantidad_equipaje").value;
  const uso = document.getElementById("uso_equipaje").value;
  const textarea = document.getElementById("equipaje");

  if (!tipo || !cantidad || !uso) {
    alert("Por favor completa los tres campos antes de agregar el equipaje.");
    return;
  }

  const linea = `${cantidad} ${tipo.toLowerCase()}(s) ${uso}`;
  textarea.value += (textarea.value ? '\n' : '') + linea;

  // Limpiar campos
  document.getElementById("tipo_equipaje").value = "";
  document.getElementById("cantidad_equipaje").value = "";
  document.getElementById("uso_equipaje").value = "";
}
async function cargarDestinos() {
  try {
const ref = db.collection("tours");
const snapshot = await ref.get();
    const select = document.getElementById("destino");

    snapshot.forEach(doc => {
      const data = doc.data();
      const opt = document.createElement("option");
      opt.value = doc.id; // El ID del documento sigue como value
      opt.textContent = data.nombre || doc.id; // Pero el texto que se muestra es el nombre
      select.appendChild(opt);
    });
  } catch (e) {
    console.error("Error al cargar destinos:", e);
  }

  // Cargar la info completa del tour al seleccionar un destino
function cargarInfoTour(destinoId) {
  if (!destinoId) return;

  db.collection("tours").doc(destinoId).get()
    .then(doc => {
      if (doc.exists) {
        const data = doc.data();
        document.getElementById("duracion").value = data.duracion || "";
        const hotelSelect = document.getElementById("hotelNombre");
hotelSelect.innerHTML = '<option value="">Seleccione un hotel</option>';

if (Array.isArray(data.hoteles)) {
  data.hoteles.forEach(hotel => {
    const option = document.createElement("option");
    option.value = hotel.nombre || hotel; // por si es solo string
    option.textContent = hotel.nombre || hotel;
    hotelSelect.appendChild(option);
  });
}
        document.getElementById("itinerario").value = data.itinerario_tours || "";

        const lista = document.getElementById("toursOpcionalesLista");
        lista.innerHTML = "";
        if (Array.isArray(data.tours_opcionales)) {
          data.tours_opcionales.forEach(item => {
            const card = document.createElement("div");
            card.style = `
              border: 1px solid #ccc;
              padding: 10px 15px;
              border-radius: 8px;
              background: #f9f9f9;
              display: flex;
              align-items: center;
              gap: 10px;
              min-width: 250px;
            `;
            card.innerHTML = `
              <input type="checkbox" name="opcionales" value="${item.nombre}">
              <span><strong>${item.nombre}</strong> - $${item.precio}</span>
            `;
            lista.appendChild(card);
          });
        }
      }
    })
    .catch(e => {
      console.error("Error al cargar información del tour:", e);
    });
}

// ✅ Exponer después de la función
window.cargarInfoTour = cargarInfoTour;
}
  function autoResizeTextarea(textarea) {
    textarea.style.height = 'auto'; // reset
    textarea.style.height = (textarea.scrollHeight + 2) + 'px'; // ajuste real
  }
function abrirModalHotel() {
  const destinoSeleccionado = document.getElementById("destino").value;
  const selectHotel = document.getElementById("modal_nombreHotel");

  // Reset
  selectHotel.innerHTML = "<option value=''>Cargando hoteles...</option>";

  db.collection("tours").doc(destinoSeleccionado).get().then(doc => {
    if (doc.exists) {
      const data = doc.data();
      selectHotel.innerHTML = ""; // limpiar

      if (Array.isArray(data.hoteles)) {
        data.hoteles.forEach(hotel => {
          const opt = document.createElement("option");
          opt.value = hotel.nombre;
          opt.textContent = hotel.nombre;
          selectHotel.appendChild(opt);
        });
      }
    }
  });

  document.getElementById("modalHotel").style.display = "flex";
}

function cerrarModalHotel() {
  document.getElementById("modalHotel").style.display = "none";
}

function guardarHotelModal() {
  const hotel = document.getElementById("modal_nombreHotel").value;
  const checkIn = document.getElementById("modal_checkIn").value;
  const checkOut = document.getElementById("modal_checkOut").value;
  const tipo = document.getElementById("modal_tipoHabitacion").value;
  const cantidad = document.getElementById("modal_cantidad").value;
  const obs = document.getElementById("modal_observaciones").value;

  const tbody = document.getElementById("tablaHotelesBody");
  const row = document.createElement("tr");

  row.innerHTML = `
    <td>${hotel}</td>
    <td>${checkIn}</td>
    <td>${checkOut}</td>
    <td>${tipo}</td>
    <td>${cantidad}</td>
    <td>${obs || 'Sin observaciones'}</td>
  `;

  tbody.appendChild(row);
  cerrarModalHotel();
}

  function verificarFilasHabitaciones() {
  const tabla = document.getElementById("tablaResumenHabitaciones");
  const tieneFilas = tabla.querySelector("tbody").children.length > 0;
  tabla.style.display = tieneFilas ? "table" : "none";
}
  // Aplicar a todos los que tengan la clase autoresize
    document.querySelectorAll('.autoresize').forEach(textarea => {
      textarea.addEventListener('input', () => autoResizeTextarea(textarea));
      autoResizeTextarea(textarea); // inicial
    });
  // Ejecutar al cargar la página
document.addEventListener("DOMContentLoaded", () => {
  cargarDestinos();
  document.getElementById("btnAgregarVuelo").addEventListener("click", agregarVueloIntermedio);
  window.abrirModalHotel = abrirModalHotel;
window.cerrarModalHotel = cerrarModalHotel;
window.guardarHotelModal = guardarHotelModal;
});
</script>

</body>
</html>
